Accumulators can help you with the homework https://docs.mongodb.com/manual/meta/aggregation-quick-reference/index.html